import{_ as T,a as A,b as R,c as S,d as V,e as E}from"./DZ3TSjdJ.js";import{d as H,a8 as L,X as O,m as j,n as z,K as d,A as G,y as w,I as x,c as I,h as l,a as s,i as _,e as P,b as v,a9 as k,z as $,o as i}from"./BFrj2aVI.js";import"./CD5_m4RY.js";import"./C-8UdED7.js";import"./wNlFRyfG.js";import"./BGNol3OQ.js";const K={key:0,class:"container flex items-start gap-16 px-2"},Q={class:"w-full"},X={class:"flex items-center justify-between w-full gap-4 mt-8 md:gap-8"},ne=H({__name:"products",async setup(J){var y,h,g;let r,a;const{loadProductsForPage:q,updateProductList:u,products:F,getCurrentPageFromRoute:D}=L(),t=O(),{storeSettings:p}=j(),{isQueryEmpty:N}=z();d({title:"Products",meta:[{name:"description",content:"Discover our products"}]});const b=G(()=>({search:t.query.search,categoryIn:t.query.category?[t.query.category]:void 0,priceMin:t.query.priceMin?parseFloat(t.query.priceMin):void 0,priceMax:t.query.priceMax?parseFloat(t.query.priceMax):void 0,onSale:t.query.sale==="true"?!0:void 0,orderby:t.query.orderby||"DATE"})),{data:m}=([r,a]=w(async()=>k("shopPage",async()=>{try{const{data:o}=await $("getShopPage");return o.value}catch(o){return console.warn("Не можахме да заредим SEO данните:",o),null}})),r=await r,a(),r);if((h=(y=m.value)==null?void 0:y.page)!=null&&h.seo){const o=m.value.page,e=o.seo,n=(e==null?void 0:e.title)||o.title||"Products",c=(e==null?void 0:e.metaDesc)||o.content||"Discover our products";d({title:n,meta:[{name:"description",content:c},{property:"og:title",content:(e==null?void 0:e.opengraphTitle)||n},{property:"og:description",content:(e==null?void 0:e.opengraphDescription)||c},{name:"robots",content:e!=null&&e.metaRobotsNoindex?"noindex":"index"},{name:"robots",content:e!=null&&e.metaRobotsNofollow?"nofollow":"follow"}],link:[{rel:"canonical",href:(e==null?void 0:e.canonical)||"/products"}]}),(g=e==null?void 0:e.schema)!=null&&g.raw&&d({script:[{type:"application/ld+json",innerHTML:e.schema.raw}]})}return[r,a]=w(async()=>k("initialProducts",async()=>{try{const o=D();return await q(o,b.value),N.value||await u(),!0}catch(o){return console.error("Грешка при зареждане на продукти:",o),!1}})),await r,a(),x(()=>t.query,()=>{t.name!=="products"&&t.name!=="product-page-pager"||u()}),x(()=>t.params,()=>{t.name!=="products"&&t.name!=="product-page-pager"||u()}),(o,e)=>{var f;const n=S,c=A,C=V,B=E,M=R,U=T;return(f=s(F))!=null&&f.length,i(),I("div",K,[s(p).showFilters?(i(),l(n,{key:0})):_("",!0),P("div",Q,[P("div",X,[v(c),s(p).showOrderByDropdown?(i(),l(C,{key:0,class:"hidden md:inline-flex"})):_("",!0),s(p).showFilters?(i(),l(B,{key:1,class:"md:hidden"})):_("",!0)]),v(M)])])}}});export{ne as default};
