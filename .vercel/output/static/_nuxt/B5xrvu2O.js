import{a as N,b as T,c as E,d as S,e as V}from"./C_oc3ba4.js";import{d as A,a8 as H,n as O,m as R,X as j,K as _,C as G,z as I,I as F,c as L,i as g,a as i,h as y,e as k,b as v,o as u}from"./CyBGr-YO.js";import"./CO4MXo0O.js";import"./DDYUcn6y.js";import"./DXb2HN8e.js";import"./CIAHthuC.js";const $={key:0,class:"container flex items-start gap-16 px-2"},z={class:"w-full"},K={class:"flex items-center justify-between w-full gap-4 mt-8 md:gap-8"},ee=A({__name:"[slug]",setup(Q){const{loadProductsForPage:C,updateProductList:p,products:M,getCurrentPageFromRoute:D}=H(),{isQueryEmpty:B}=O(),{storeSettings:d}=R(),e=j(),h=e.params.slug;_({title:"Products",meta:[{name:"description",content:"Products in this category"}]});const b={categoryIn:[h],search:e.query.search,priceMin:e.query.priceMin?parseFloat(e.query.priceMin):void 0,priceMax:e.query.priceMax?parseFloat(e.query.priceMax):void 0,onSale:e.query.sale==="true"?!0:void 0,orderby:e.query.orderby||"DATE"};return G(async()=>{var l,m,r,s,n,a,c,f,w,P;try{const{data:o}=await I("getProductCategories",{first:1,slug:[h]}),t=((r=(m=(l=o.value)==null?void 0:l.productCategories)==null?void 0:m.nodes)==null?void 0:r[0])||null;if(t!=null&&t.seo){const x=((s=t.seo)==null?void 0:s.title)||t.name||"Products",q=((n=t.seo)==null?void 0:n.metaDesc)||t.description||"Products in this category";_({title:x,meta:[{name:"description",content:q},{property:"og:title",content:((a=t.seo)==null?void 0:a.opengraphTitle)||x},{property:"og:description",content:((c=t.seo)==null?void 0:c.opengraphDescription)||q}],link:[{rel:"canonical",href:((f=t.seo)==null?void 0:f.canonical)||""}]}),(P=(w=t.seo)==null?void 0:w.schema)!=null&&P.raw&&_({script:[{type:"application/ld+json",innerHTML:t.seo.schema.raw}]})}}catch(o){console.warn("Не можахме да заредим SEO данните за категорията (очаквано при първо зареждане):",o)}try{const o=D();await C(o,b),B.value||p()}catch(o){console.error("Грешка при зареждане на продукти за категорията:",o)}}),F(()=>e.query,()=>{e.name==="product-category-slug"&&p()}),F(()=>e.params,()=>{e.name==="product-category-slug"&&p()}),(l,m)=>{const r=E,s=N,n=S,a=V,c=T;return i(M).length,u(),L("div",$,[i(d).showFilters?(u(),y(r,{key:0,"hide-categories":!0})):g("",!0),k("div",z,[k("div",K,[v(s),i(d).showOrderByDropdown?(u(),y(n,{key:0,class:"hidden md:inline-flex"})):g("",!0),i(d).showFilters?(u(),y(a,{key:1,class:"md:hidden"})):g("",!0)]),v(c)])])}}});export{ee as default};
