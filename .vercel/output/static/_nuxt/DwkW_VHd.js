import{q as E,n as M,r as B,f as C,l as H,g as U,a as j,b as D,h as V}from"./B8LMokGs.js";import{_ as O}from"./BHdBlYJu.js";import{q as S,d as c,v as P,N as u,O as o,J as r,Z as t,V as w,D as n,c as k,Q as y,$ as v,P as N,T as z,a1 as A}from"./BLv-qrLK.js";import"./BZpiv6Tl.js";const J={class:"max-w-lg mx-auto my-16 min-h-[600px] lg:my-24"},K={class:"flex flex-col items-center"},Q={class:"text-xl font-semibold lg:text-3xl"},W={for:"password",class:"mb-4"},Z={for:"confirmPassword",class:"mb-4"},F={key:0,class:"text-sm mb-4"},G=["innerHTML"],X={class:"flex items-center justify-center gap-4 mt-4 text-lg"},Y={class:"my-8 text-center cursor-pointer"},ss=S({__name:"ResetPassword",setup(R){const{t:a}=E(),i=M(),d=B(),{viewer:$,resetPasswordWithKey:q,loginUser:L}=C(),l=c(""),m=c(""),_=c(""),g=c(!1),f=c(!1);!d.query.key&&!d.query.login&&i.push("/my-account?action=forgotPassword");const I=async()=>{try{if(_.value="",f.value=!1,g.value=!0,l.value!==m.value)throw new Error(a("messages.error.passwordMismatch"));const e={key:d.query.key,login:d.query.login,password:l.value};if(!e.key||!e.login)throw f.value=!0,new Error(a("messages.error.invalidPasswordResetLink"));const s=await q(e);if(!s.success)throw f.value=!0,new Error(s.error);if($.value){const p=await L({username:e.login,password:e.password});if(!p.success)throw new Error(p.error)}i.push("/my-account")}catch(e){_.value=e.message||a("messages.error.general")}finally{g.value=!1}};return H({title:a("messages.account.resetPassword")}),(e,s)=>{const p=U,h=O,b=j,T=D;return u(),P("div",J,[o("div",K,[r(p,{class:"mb-6 scale-125"}),o("h1",Q,t(e.$t("messages.account.resetPassword")),1)]),o("form",{class:"mt-6 flex flex-col",onSubmit:A(I,["prevent"])},[o("label",W,[w(t(e.$t("messages.account.newPassword"))+" ",1),s[2]||(s[2]=o("span",{class:"text-red-500"},"*",-1)),s[3]||(s[3]=o("br",null,null,-1)),r(h,{id:"password",className:" border rounded-lg w-full p-3 px-4 bg-white",modelValue:n(l),"onUpdate:modelValue":s[0]||(s[0]=x=>k(l)?l.value=x:null),placeholder:"New Password",required:!0},null,8,["modelValue"])]),o("label",Z,[w(t(e.$t("messages.account.confirmNewPassword"))+" ",1),s[4]||(s[4]=o("span",{class:"text-red-500"},"*",-1)),s[5]||(s[5]=o("br",null,null,-1)),r(h,{id:"confirmPassword",className:"border rounded-lg w-full p-3 px-4 bg-white",modelValue:n(m),"onUpdate:modelValue":s[1]||(s[1]=x=>k(m)?m.value=x:null),placeholder:"Confirm Password",required:!0},null,8,["modelValue"])]),r(z,{name:"scale-y",mode:"out-in"},{default:y(()=>[n(_)?(u(),P("div",F,[o("span",{class:"text-red-500",innerHTML:n(_)},null,8,G),n(f)?(u(),N(b,{key:0,class:"underline cursor-pointer pl-1",to:"/my-account?action=forgotPassword"},{default:y(()=>[w(t(e.$t("messages.account.requestNewLink")),1)]),_:1})):v("",!0)])):v("",!0)]),_:1}),o("button",X,[n(g)?(u(),N(T,{key:0,stroke:"4",size:"16",color:"#fff"})):v("",!0),o("span",null,t(e.$t("messages.account.resetPassword")),1)])],32),o("div",Y,[r(b,{to:"/my-account"},{default:y(()=>[w(t(e.$t("messages.account.backToLogin")),1)]),_:1})])])}}}),es=Object.assign(V(ss,[["__scopeId","data-v-80e2df9f"]]),{__name:"ResetPassword"}),os={},ts={class:"container min-h-[600px]"};function ns(R,a){const i=es;return u(),P("div",ts,[r(i)])}const us=V(os,[["render",ns]]);export{us as default};
