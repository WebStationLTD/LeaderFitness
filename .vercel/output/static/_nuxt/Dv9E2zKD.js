import{q as se,d as oe,h as F,t as he,_ as Q,r as pe,u as fe,a as ve,b as be}from"./B8LMokGs.js";import{q as O,y as g,v as c,$ as f,D as l,N as s,Z as N,P as S,I as M,X as ae,J as z,af as ye,d as j,B as Y,O as m,Q as ee,V as te,_ as _e,a1 as A,a0 as xe,c as we}from"./BLv-qrLK.js";import{_ as Ie}from"./DKMn0Wwy.js";import{_ as Pe}from"./DT59Ktqr.js";import{a as ne}from"./CzxjUVWS.js";const ke={key:0,class:"red-badge"},Ce=O({__name:"SaleBadge",props:{node:{type:Object,required:!0}},setup(e){const{t:v}=se(),{storeSettings:b}=oe(),I=g(()=>{var P,p,R,T;if(!((P=e.node)!=null&&P.salePrice)||!((p=e.node)!=null&&p.regularPrice))return"";const o=parseFloat((R=e.node)==null?void 0:R.salePrice),h=parseFloat((T=e.node)==null?void 0:T.regularPrice);return Math.round((h-o)/h*100)+" %"}),u=g(()=>e.node.salePrice&&b.saleBadge!=="hidden"),$=g(()=>(b==null?void 0:b.saleBadge)==="percent"?I.value:v("messages.shop.onSale")?v("messages.shop.onSale"):"Sale");return(o,h)=>l(u)?(s(),c("span",ke,N(l($)),1)):f("",!0)}}),Be=Object.assign(F(Ce,[["__scopeId","data-v-69615c4f"]]),{__name:"SaleBadge"}),Se=["title"],$e=O({__name:"ProductWishlistButton",props:{product:{}},setup(e){const{addToWishlist:v,removeFromWishlist:b,isInList:I}=he(),u=e,$=g(()=>u.product.databaseId?I(u.product.databaseId):!1),o=h=>{h.preventDefault(),h.stopPropagation(),$.value&&u.product.databaseId?b(u.product.databaseId):v(u.product)};return(h,P)=>{const p=Q;return s(),c("button",{type:"button",class:"absolute top-2 left-2 z-40 bg-white/80 hover:bg-white rounded-full shadow-md transition-all duration-200 wishlist-btn",onClick:o,title:l($)?h.$t("messages.shop.wishlistRemove"):h.$t("messages.shop.wishlistAdd")},[l($)?(s(),S(p,{key:0,name:"ion:heart",size:"24",class:"text-red-500 md:w-6 md:h-6 w-5 h-5"})):(s(),S(p,{key:1,name:"ion:heart-outline",size:"24",class:"text-gray-600 md:w-6 md:h-6 w-5 h-5"}))],8,Se)}}}),je=Object.assign(F($e,[["__scopeId","data-v-097c071d"]]),{__name:"ProductWishlistButton"}),ze={class:"inline-flex items-center"},Ne={key:0,class:"text-xs ml-1 text-gray-500"},Re=O({__name:"StarRating",props:{rating:{type:Number,default:0},count:{type:Number,default:null},hideCount:{type:Boolean,default:!1},size:{type:Number,default:14}},setup(e){return(v,b)=>{const I=Q;return s(),c("div",ze,[(s(),c(M,null,ae(5,u=>z(I,{key:u,name:"ion:star",size:e.size+"",class:"mr-[2px]",style:ye({color:e.rating<u?"#ccc":"#FBBE24"})},null,8,["size","style"])),64)),e.count!==null&&!e.hideCount?(s(),c("span",Ne,"("+N(e.count)+")",1)):f("",!0)])}}}),Te=Object.assign(Re,{__name:"StarRating"}),Ve={class:"relative group"},qe={class:"mb-2 font-light leading-tight group-hover:text-primary"},De={class:"flex flex-col items-start sm:flex-row sm:items-center sm:justify-between mb-3 min-h-[26px]"},We={key:0,class:"flex w-full mt-2 sm:mt-0 sm:justify-end sm:w-[100px]"},Le=["value","selected"],Me={key:2,class:"text-red-500 text-xs -mt-2 mb-3"},Oe={key:3},Ue={class:"flex items-center justify-between space-x-2"},Ee={class:"flex items-center h-8 bg-white border border-gray-300 rounded-md"},Ae=["disabled"],Fe=["disabled"],L=280,Qe=O({__name:"ProductCardDetailed",props:{node:{type:Object,required:!0},index:{type:Number,default:1}},setup(e){var J,X,Z,G;const v=pe(),{storeSettings:b}=oe(),{addToCart:I,cart:u}=fe(),{t:$}=se(),o=e,h=Math.round(L*1.125),P=j((J=v.query)==null?void 0:J.filter),p=j(((G=(Z=(X=P.value)==null?void 0:X.split("pa_color[")[1])==null?void 0:Z.split("]")[0])==null?void 0:G.split(","))||[]);Y(()=>v.query,()=>{var n,t,r;P.value=v.query.filter,p.value=((r=(t=(n=P.value)==null?void 0:n.split("pa_color[")[1])==null?void 0:t.split("]")[0])==null?void 0:r.split(","))||[]});const R=g(()=>{var n,t,r,d;return((t=(n=o.node)==null?void 0:n.image)==null?void 0:t.producCardSourceUrl)||((d=(r=o.node)==null?void 0:r.image)==null?void 0:d.sourceUrl)||"/images/placeholder.jpg"}),T=g(()=>{var n,t,r,d,i,y;if(p.value.length){const B=(t=(n=o.node)==null?void 0:n.variations)==null?void 0:t.nodes.filter(D=>{var q;const W=(q=D.attributes)==null?void 0:q.nodes.some(x=>p.value.some(a=>{var w;return(w=x==null?void 0:x.value)==null?void 0:w.includes(a)})),E=p.value.some(x=>{var a;return(a=D.slug)==null?void 0:a.includes(x)});return W||E});if(B!=null&&B.length)return((d=(r=B[0])==null?void 0:r.image)==null?void 0:d.producCardSourceUrl)||((y=(i=B[0])==null?void 0:i.image)==null?void 0:y.sourceUrl)||R.value}return R.value}),V=j(!1),_=j(1),k=j(""),C=j(null),H=g(()=>{var n;return((n=o.node)==null?void 0:n.type)===ne.VARIABLE}),le=g(()=>{var n;return((n=o.node)==null?void 0:n.type)===ne.SIMPLE}),U=g(()=>{var n,t;return H.value&&((t=(n=o.node)==null?void 0:n.variations)==null?void 0:t.nodes)!==void 0&&o.node.variations.nodes.length>0}),re=g(()=>H.value||le.value),ie=g(()=>V.value||U.value&&!C.value),de=()=>_.value++,ce=()=>{_.value>1&&_.value--},ue=n=>{var r,d,i;if(C.value=n,!((i=(d=(r=o.node)==null?void 0:r.variations)==null?void 0:d.nodes)==null?void 0:i.find(y=>y.databaseId===n))){k.value="Invalid variation selected";return}},me=async()=>{var n;if((n=o.node)!=null&&n.databaseId){if(U.value&&!C.value){k.value="Моля, изберете вариация";return}V.value=!0,k.value="";try{const t={productId:o.node.databaseId,quantity:_.value,variationId:C.value};await I(t)}catch(t){console.error("Грешка при добавяне в количката:",t),k.value="Възникна грешка при добавяне в количката"}finally{setTimeout(()=>{V.value=!1},500)}}};return Y(u,()=>{setTimeout(()=>{V.value=!1,k.value=""},300)}),g(()=>{var n,t,r,d;if(C.value&&((t=(n=o.node)==null?void 0:n.variations)!=null&&t.nodes)){const i=o.node.variations.nodes.find(y=>y.databaseId===C.value);return(i==null?void 0:i.salePrice)!==null&&(i==null?void 0:i.salePrice)!==void 0}return((r=o.node)==null?void 0:r.salePrice)!==null&&((d=o.node)==null?void 0:d.salePrice)!==void 0}),(n,t)=>{var q,x;const r=Be,d=je,i=Ie,y=ve,B=Te,D=Pe,W=Q,E=be;return s(),c("div",Ve,[e.node.slug?(s(),S(y,{key:0,to:`/produkt/${decodeURIComponent(e.node.slug)}`,title:e.node.name},{default:ee(()=>{var a,w;return[z(r,{node:e.node,class:"absolute top-2 right-2"},null,8,["node"]),z(d,{product:e.node},null,8,["product"]),l(T)?(s(),S(i,{key:0,width:L,height:l(h),src:l(T),alt:((a=e.node.image)==null?void 0:a.altText)||e.node.name||"Product image",title:((w=e.node.image)==null?void 0:w.title)||e.node.name,loading:e.index<=3?"eager":"lazy",sizes:`sm:${L/2}px md:${L}px`,class:"rounded-lg object-top object-cover w-full aspect-9/8",placeholder:"","placeholder-class":"blur-xl"},null,8,["height","src","alt","title","loading","sizes"])):f("",!0)]}),_:1},8,["to","title"])):f("",!0),m("div",null,[l(b).showReviews?(s(),S(B,{key:0,rating:e.node.averageRating||0,count:e.node.reviewCount||0},null,8,["rating","count"])):f("",!0),e.node.slug?(s(),S(y,{key:1,to:`/produkt/${decodeURIComponent(e.node.slug)}`,title:e.node.name},{default:ee(()=>[m("h2",qe,N(e.node.name),1)]),_:1},8,["to","title"])):f("",!0),m("div",De,[z(D,{class:"text-sm","sale-price":e.node.salePrice,"regular-price":e.node.regularPrice},null,8,["sale-price","regular-price"]),l(U)?(s(),c("div",We,[m("select",{class:"text-xs py-1 px-2 border border-gray-300 rounded focus:outline-none focus:border-gray-400 bg-white w-full sm:max-w-[160px]",onChange:t[0]||(t[0]=a=>ue(Number(a.target.value)))},[t[2]||(t[2]=m("option",{value:"",disabled:"",selected:""},"Вариации",-1)),(s(!0),c(M,null,ae((x=(q=e.node)==null?void 0:q.variations)==null?void 0:x.nodes,a=>{var w,K;return s(),c("option",{key:a.databaseId,value:a.databaseId,selected:l(C)===a.databaseId},[(K=(w=a.attributes)==null?void 0:w.nodes)!=null&&K.length?(s(),c(M,{key:0},[te(N(a.attributes.nodes.map(ge=>ge.value).filter(Boolean).join(" / ")),1)],64)):(s(),c(M,{key:1},[te(N(a.name),1)],64))],8,Le)}),128))],32)])):f("",!0)]),l(k)?(s(),c("div",Me,N(l(k)),1)):f("",!0),l(re)?(s(),c("div",Oe,[m("div",Ue,[m("div",Ee,[m("button",{onClick:A(ce,["prevent"]),type:"button",class:"flex items-center justify-center w-6 h-full text-xs text-gray-500 transition-colors border-r border-gray-300 hover:bg-gray-50",disabled:l(_)<=1},[z(W,{name:"ion:remove",size:"14"})],8,Ae),_e(m("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>we(_)?_.value=a:null),type:"number",min:"1",class:"w-8 h-full text-xs text-center bg-transparent focus:outline-none"},null,512),[[xe,l(_),void 0,{number:!0}]]),m("button",{onClick:A(de,["prevent"]),type:"button",class:"flex items-center justify-center w-6 h-full text-xs text-gray-500 transition-colors border-l border-gray-300 hover:bg-gray-50"},[z(W,{name:"ion:add",size:"14"})])]),m("button",{onClick:A(me,["prevent"]),type:"button",disabled:l(ie),class:"flex items-center justify-center flex-1 h-8 px-3 text-xs font-medium text-white transition-colors bg-gray-800 rounded-md hover:bg-gray-900 disabled:bg-gray-400 disabled:cursor-not-allowed"},[t[3]||(t[3]=m("span",null,"Купи",-1)),l(V)?(s(),S(E,{key:0,stroke:"3",size:"10",color:"#fff",class:"ml-1"})):f("",!0)],8,Fe)])])):f("",!0)])])}}}),Ke=Object.assign(F(Qe,[["__scopeId","data-v-aaa5f5f1"]]),{__name:"ProductCardDetailed"});export{Ke as _,Be as a,Te as b};
