import{f as S,r as H,n as W,d as J,a as Q,_ as F,q as X,g as Z,b as Y,h as C}from"./B8LMokGs.js";import{L as ee}from"./CzxjUVWS.js";import{q as G,y,v as c,$ as l,D as e,N as a,O as n,I as se,X as oe,P as k,Q as E,Z as p,W as te,d as U,B as re,J as R,_ as N,a0 as B,T as z,V,ad as ae,a1 as ne}from"./BLv-qrLK.js";import{_ as ie}from"./BHdBlYJu.js";import"./BZpiv6Tl.js";const le={key:0},ce={key:2},ue={class:"flex items-center justify-center gap-4 my-8 leading-none"},me={class:"text-gray-400"},de=G({__name:"LoginProviders",setup(K){const{loginClients:r,loginWithProvider:x}=S(),b=H(),A=W(),{storeSettings:h}=J(),{provider:L,code:P,state:g}=b.query;P&&g&&L&&x(g,P,L.toUpperCase()).then(()=>{A.replace({query:{}})}).catch(m=>{console.error("Login failed:",m)});const o={FACEBOOK:"ion:logo-facebook",GITHUB:"ion:logo-github",GOOGLE:"ion:logo-google",INSTAGRAM:"ion:logo-instagram",LINKEDIN:"ion:logo-linkedin"},_=(h==null?void 0:h.socialLoginsDisplay)||"buttons",u=y(()=>{var m;return((m=r.value)==null?void 0:m.filter(f=>(f==null?void 0:f.provider)!==ee.PASSWORD))||[]}),D=m=>m?`Login with ${m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()}`:"Login";return(m,f)=>{var $;const j=F,w=F,q=Q;return($=e(u))!=null&&$.length?(a(),c("div",le,[n("div",{class:te(["gap-4",e(_)==="buttons"?"grid gap-4 grid-cols-[repeat(auto-fit,minmax(180px,1fr))] justify-center":" flex gap-4 flex-wrap justify-center"])},[(a(!0),c(se,null,oe(e(u),(d,T)=>(a(),c("div",{key:T},[d&&(d!=null&&d.authorizationUrl)?(a(),k(q,{key:0,to:d==null?void 0:d.authorizationUrl,class:"flex items-center justify-center gap-3 p-3 bg-white rounded-lg shadow-sm hover:shadow transition duration-100 ease-in-out"},{default:E(()=>[d.provider?(a(),k(j,{key:0,name:o[d.provider],size:"20"},null,8,["name"])):(a(),k(w,{key:1,name:"ion:log-in",size:"20"})),e(_)==="buttons"?(a(),c("span",ce,p(d.name||D(d.provider)),1)):l("",!0)]),_:2},1032,["to"])):l("",!0)]))),128))],2),n("div",ue,[f[0]||(f[0]=n("div",{class:"border-b w-1/3 flex-1"},null,-1)),n("div",me,p(m.$t("messages.account.orContinueWithEmail")),1),f[1]||(f[1]=n("div",{class:"border-b w-1/3 flex-1"},null,-1))])])):l("",!0)}}}),ge=Object.assign(de,{__name:"LoginProviders"}),pe={class:"max-w-lg mx-auto my-16 min-h-[600px] text-center"},fe={class:"flex flex-col my-2"},_e={class:"text-xl font-semibold lg:text-3xl"},ve={key:0,for:"email"},ye=["placeholder"],we={key:1,class:"text-sm text-gray-500"},xe={key:2},be=["placeholder"],he=["innerHTML"],ke=["innerHTML"],Le={class:"flex items-center justify-between mt-4"},Pe={class:"flex items-center gap-2"},$e={class:"flex items-center justify-center gap-4 my-6 text-lg"},Te={key:1,class:"my-6 text-center"},Ue={key:2,class:"my-2 text-center justify-center"},Re=G({__name:"LoginAndRegister",setup(K){const{t:r}=X(),x=H(),b=W(),{loginUser:A,isPending:h,registerUser:L,sendResetPasswordEmail:P}=S(),g=U({email:"",password:"",username:"",rememberMe:!1}),o=U("login"),_=U(""),u=U("");re(x,()=>{x.query.action==="forgotPassword"?o.value="forgotPassword":x.query.action==="register"?o.value="register":o.value="login"},{immediate:!0});const m=async t=>{const{success:s,error:v}=await A(t);switch(v){case"invalid_username":u.value=r("messages.error.invalidUsername");break;case"incorrect_password":u.value=r("messages.error.incorrectPassword");break;default:u.value=v;break}s&&(u.value="",_.value=r("messages.account.loggingIn"))},f=async t=>{if(o.value==="register"){const{email:s,password:v,username:M}=t,I={email:s,password:v,username:M},{success:O,error:i}=await L(I);O?(u.value="",_.value=r("messages.account.accountCreated")+" "+r("messages.account.loggingIn"),setTimeout(()=>{m(t)},2e3)):u.value=i}else o.value==="forgotPassword"?j(t):m(t)},j=async t=>{const{success:s,error:v}=await P({username:t.email});s?(u.value="",_.value=r("messages.account.ifRegistered")):u.value=v},w=t=>{o.value=t,t==="forgotPassword"?b.push({query:{action:"forgotPassword"}}):t==="register"?b.push({query:{action:"register"}}):b.push({query:{}})},q=y(()=>{if(o.value==="login")return r("messages.account.loginToAccount");if(o.value==="register")return r("messages.account.accountRegister");if(o.value==="forgotPassword")return r("messages.account.forgotPassword")}),$=y(()=>{if(o.value==="login")return r("messages.account.login");if(o.value==="register")return r("messages.account.register");if(o.value==="forgotPassword")return r("messages.account.sendPasswordResetEmail")});y(()=>o.value==="register"?r("messages.billing.email"):r("messages.account.emailOrUsername")),y(()=>o.value==="login"?r("messages.account.emailOrUsername"):r("messages.account.username"));const d=y(()=>r("messages.account.password")),T=y(()=>({email:"johndoe@email.com",username:o.value==="login"?"johndoe@email.com":"johndoe",password:"********"}));return(t,s)=>{const v=Z,M=ge,I=ie,O=Y;return a(),c("div",pe,[R(v),n("div",fe,[n("h1",_e,p(e(q)),1),s[9]||(s[9]=n("p",{class:"text-gray-500 mt-2"},"Welcome back! Select method to login.",-1))]),e(o)==="login"||e(o)==="register"?(a(),k(M,{key:0,class:"my-8"})):l("",!0),n("form",{class:"mt-6",onSubmit:s[5]||(s[5]=ne(i=>f(e(g)),["prevent"]))},[e(o)==="register"||e(o)==="forgotPassword"?(a(),c("div",ve,[N(n("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=i=>e(g).email=i),placeholder:e(T).email,autocomplete:"email",type:"text",required:""},null,8,ye),[[B,e(g).email]])])):l("",!0),e(o)==="forgotPassword"?(a(),c("p",we,p(t.$t("messages.account.enterEmailOrUsernameForReset")),1)):l("",!0),e(o)!=="forgotPassword"?(a(),c("div",xe,[N(n("input",{class:"mt-1","onUpdate:modelValue":s[1]||(s[1]=i=>e(g).username=i),placeholder:e(T).username,autocomplete:"username",type:"text",required:""},null,8,be),[[B,e(g).username]]),R(I,{className:"border rounded-lg w-full p-3 px-4 bg-white mt-1",modelValue:e(g).password,"onUpdate:modelValue":s[2]||(s[2]=i=>e(g).password=i),placeholder:e(d),autocomplete:e(o)==="login"?"current-password":"new-password",required:!0},null,8,["modelValue","placeholder","autocomplete"])])):l("",!0),R(z,{name:"scale-y",mode:"out-in"},{default:E(()=>[e(_)?(a(),c("div",{key:0,class:"my-4 text-sm text-green-500",innerHTML:e(_)},null,8,he)):l("",!0)]),_:1}),R(z,{name:"scale-y",mode:"out-in"},{default:E(()=>[e(u)?(a(),c("div",{key:0,class:"my-4 text-sm text-red-500",innerHTML:e(u)},null,8,ke)):l("",!0)]),_:1}),n("div",Le,[n("label",Pe,[N(n("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>e(g).rememberMe=i),type:"checkbox"},null,512),[[ae,e(g).rememberMe]]),s[10]||(s[10]=V("Remember me "))]),e(o)==="login"?(a(),c("div",{key:0,class:"font-semibold cursor-pointer text-sm text-primary hover:text-primary",onClick:s[4]||(s[4]=i=>w("forgotPassword"))}," Forgot password? ")):l("",!0)]),n("button",$e,[e(h)?(a(),k(O,{key:0,stroke:"4",size:"16",color:"#fff"})):l("",!0),n("span",null,p(e($)),1)])],32),e(o)==="login"?(a(),c("div",Te,[V(p(t.$t("messages.account.noAccount"))+" ",1),n("a",{class:"font-semibold cursor-pointer text-primary",onClick:s[6]||(s[6]=i=>w("register"))},p(t.$t("messages.account.accountRegister")),1),s[11]||(s[11]=V(". "))])):l("",!0),e(o)==="register"?(a(),c("div",Ue,[V(p(t.$t("messages.account.hasAccount"))+" ",1),n("a",{class:"font-semibold cursor-pointer text-primary",onClick:s[7]||(s[7]=i=>w("login"))},p(t.$t("messages.general.please"))+" "+p(t.$t("messages.account.accountLogin")),1)])):l("",!0),e(o)==="forgotPassword"?(a(),c("div",{key:3,class:"my-8 text-center cursor-pointer",onClick:s[8]||(s[8]=i=>w("login"))},p(t.$t("messages.account.backToLogin")),1)):l("",!0)])}}}),Ie=Object.assign(C(Re,[["__scopeId","data-v-48dd173d"]]),{__name:"LoginAndRegister"});export{Ie as default};
