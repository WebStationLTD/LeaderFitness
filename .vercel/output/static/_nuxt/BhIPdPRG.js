import{d as U,W as se,m as oe,A as g,c,i as f,a as l,o as s,t as R,v as O,a5 as he,h as S,_ as Q,F as M,r as ae,b as z,a4 as pe,X as fe,u as ve,B as $,I as Z,e as m,w as ee,g as te,Q as be,j as F,R as ye,T as _e,f as xe,k as we}from"./8-GQfn7S.js";import{_ as Ie}from"./CcNeJQci.js";import{_ as ke}from"./DxO2H-Ar.js";import{a as ne}from"./DTpPYt9C.js";const Pe={key:0,class:"red-badge"},Ce=U({__name:"SaleBadge",props:{node:{type:Object,required:!0}},setup(e){const{t:v}=se(),{storeSettings:b}=oe(),I=g(()=>{var k,p,N,T;if(!((k=e.node)!=null&&k.salePrice)||!((p=e.node)!=null&&p.regularPrice))return"";const o=parseFloat((N=e.node)==null?void 0:N.salePrice),h=parseFloat((T=e.node)==null?void 0:T.regularPrice);return Math.round((h-o)/h*100)+" %"}),u=g(()=>e.node.salePrice&&b.saleBadge!=="hidden"),j=g(()=>(b==null?void 0:b.saleBadge)==="percent"?I.value:v("messages.shop.onSale")?v("messages.shop.onSale"):"Sale");return(o,h)=>l(u)?(s(),c("span",Pe,R(l(j)),1)):f("",!0)}}),Be=Object.assign(O(Ce,[["__scopeId","data-v-69615c4f"]]),{__name:"SaleBadge"}),Se=["title"],je=U({__name:"ProductWishlistButton",props:{product:{}},setup(e){const{addToWishlist:v,removeFromWishlist:b,isInList:I}=he(),u=e,j=g(()=>u.product.databaseId?I(u.product.databaseId):!1),o=h=>{h.preventDefault(),h.stopPropagation(),j.value&&u.product.databaseId?b(u.product.databaseId):v(u.product)};return(h,k)=>{const p=Q;return s(),c("button",{type:"button",class:"absolute top-2 left-2 z-40 bg-white/80 hover:bg-white rounded-full shadow-md transition-all duration-200 wishlist-btn",onClick:o,title:l(j)?h.$t("messages.shop.wishlistRemove"):h.$t("messages.shop.wishlistAdd")},[l(j)?(s(),S(p,{key:0,name:"ion:heart",size:"24",class:"text-red-500 md:w-6 md:h-6 w-5 h-5"})):(s(),S(p,{key:1,name:"ion:heart-outline",size:"24",class:"text-gray-600 md:w-6 md:h-6 w-5 h-5"}))],8,Se)}}}),$e=Object.assign(O(je,[["__scopeId","data-v-097c071d"]]),{__name:"ProductWishlistButton"}),ze={class:"inline-flex items-center"},Re={key:0,class:"text-xs ml-1 text-gray-500"},Ne=U({__name:"StarRating",props:{rating:{type:Number,default:0},count:{type:Number,default:null},hideCount:{type:Boolean,default:!1},size:{type:Number,default:14}},setup(e){return(v,b)=>{const I=Q;return s(),c("div",ze,[(s(),c(M,null,ae(5,u=>z(I,{key:u,name:"ion:star",size:e.size+"",class:"mr-[2px]",style:pe({color:e.rating<u?"#ccc":"#FBBE24"})},null,8,["size","style"])),64)),e.count!==null&&!e.hideCount?(s(),c("span",Re,"("+R(e.count)+")",1)):f("",!0)])}}}),Te=Object.assign(Ne,{__name:"StarRating"}),We={class:"relative group"},Ve={class:"mb-2 font-light leading-tight group-hover:text-primary"},De={class:"flex flex-col items-start sm:flex-row sm:items-center sm:justify-between mb-3 min-h-[26px]"},qe={key:0,class:"flex w-full mt-2 sm:mt-0 sm:justify-end sm:w-[100px]"},Le=["value","selected"],Me={key:2,class:"text-red-500 text-xs -mt-2 mb-3"},Ue={key:3},Ae={class:"flex items-center justify-between space-x-2"},Ee={class:"flex items-center h-8 bg-white border border-gray-300 rounded-md"},Fe=["disabled"],Oe=["disabled"],L=280,Qe=U({__name:"ProductCardDetailed",props:{node:{type:Object,required:!0},index:{type:Number,default:1}},setup(e){var X,G,J,K;const v=fe(),{storeSettings:b}=oe(),{addToCart:I,cart:u}=ve(),{t:j}=se(),o=e,h=Math.round(L*1.125),k=$((X=v.query)==null?void 0:X.filter),p=$(((K=(J=(G=k.value)==null?void 0:G.split("pa_color[")[1])==null?void 0:J.split("]")[0])==null?void 0:K.split(","))||[]);Z(()=>v.query,()=>{var n,t,r;k.value=v.query.filter,p.value=((r=(t=(n=k.value)==null?void 0:n.split("pa_color[")[1])==null?void 0:t.split("]")[0])==null?void 0:r.split(","))||[]});const N=g(()=>{var n,t,r,d;return((t=(n=o.node)==null?void 0:n.image)==null?void 0:t.producCardSourceUrl)||((d=(r=o.node)==null?void 0:r.image)==null?void 0:d.sourceUrl)||"/images/placeholder.jpg"}),T=g(()=>{var n,t,r,d,i,y;if(p.value.length){const B=(t=(n=o.node)==null?void 0:n.variations)==null?void 0:t.nodes.filter(D=>{var V;const q=(V=D.attributes)==null?void 0:V.nodes.some(x=>p.value.some(a=>{var w;return(w=x==null?void 0:x.value)==null?void 0:w.includes(a)})),E=p.value.some(x=>{var a;return(a=D.slug)==null?void 0:a.includes(x)});return q||E});if(B!=null&&B.length)return((d=(r=B[0])==null?void 0:r.image)==null?void 0:d.producCardSourceUrl)||((y=(i=B[0])==null?void 0:i.image)==null?void 0:y.sourceUrl)||N.value}return N.value}),W=$(!1),_=$(1),P=$(""),C=$(null),H=g(()=>{var n;return((n=o.node)==null?void 0:n.type)===ne.VARIABLE}),le=g(()=>{var n;return((n=o.node)==null?void 0:n.type)===ne.SIMPLE}),A=g(()=>{var n,t;return H.value&&((t=(n=o.node)==null?void 0:n.variations)==null?void 0:t.nodes)!==void 0&&o.node.variations.nodes.length>0}),re=g(()=>H.value||le.value),ie=g(()=>W.value||A.value&&!C.value),de=()=>_.value++,ce=()=>{_.value>1&&_.value--},ue=n=>{var r,d,i;if(C.value=n,!((i=(d=(r=o.node)==null?void 0:r.variations)==null?void 0:d.nodes)==null?void 0:i.find(y=>y.databaseId===n))){P.value="Invalid variation selected";return}},me=async()=>{var n;if((n=o.node)!=null&&n.databaseId){if(A.value&&!C.value){P.value="Моля, изберете вариация";return}W.value=!0,P.value="";try{const t={productId:o.node.databaseId,quantity:_.value,variationId:C.value};await I(t)}catch(t){console.error("Грешка при добавяне в количката:",t),P.value="Възникна грешка при добавяне в количката"}finally{setTimeout(()=>{W.value=!1},500)}}};return Z(u,()=>{setTimeout(()=>{W.value=!1,P.value=""},300)}),g(()=>{var n,t,r,d;if(C.value&&((t=(n=o.node)==null?void 0:n.variations)!=null&&t.nodes)){const i=o.node.variations.nodes.find(y=>y.databaseId===C.value);return(i==null?void 0:i.salePrice)!==null&&(i==null?void 0:i.salePrice)!==void 0}return((r=o.node)==null?void 0:r.salePrice)!==null&&((d=o.node)==null?void 0:d.salePrice)!==void 0}),(n,t)=>{var V,x;const r=Be,d=$e,i=Ie,y=xe,B=Te,D=ke,q=Q,E=we;return s(),c("div",We,[e.node.slug?(s(),S(y,{key:0,to:`/produkt/${decodeURIComponent(e.node.slug)}`,title:e.node.name},{default:ee(()=>{var a,w;return[z(r,{node:e.node,class:"absolute top-2 right-2"},null,8,["node"]),z(d,{product:e.node},null,8,["product"]),l(T)?(s(),S(i,{key:0,width:L,height:l(h),src:l(T),alt:((a=e.node.image)==null?void 0:a.altText)||e.node.name||"Product image",title:((w=e.node.image)==null?void 0:w.title)||e.node.name,loading:e.index<=3?"eager":"lazy",sizes:`sm:${L/2}px md:${L}px`,class:"rounded-lg object-top object-cover w-full aspect-9/8",placeholder:"","placeholder-class":"blur-xl"},null,8,["height","src","alt","title","loading","sizes"])):f("",!0)]}),_:1},8,["to","title"])):f("",!0),m("div",null,[l(b).showReviews?(s(),S(B,{key:0,rating:e.node.averageRating||0,count:e.node.reviewCount||0},null,8,["rating","count"])):f("",!0),e.node.slug?(s(),S(y,{key:1,to:`/produkt/${decodeURIComponent(e.node.slug)}`,title:e.node.name},{default:ee(()=>[m("h2",Ve,R(e.node.name),1)]),_:1},8,["to","title"])):f("",!0),m("div",De,[z(D,{class:"text-sm","sale-price":e.node.salePrice,"regular-price":e.node.regularPrice},null,8,["sale-price","regular-price"]),l(A)?(s(),c("div",qe,[m("select",{class:"text-xs py-1 px-2 border border-gray-300 rounded focus:outline-none focus:border-gray-400 bg-white w-full sm:max-w-[160px]",onChange:t[0]||(t[0]=a=>ue(Number(a.target.value)))},[t[2]||(t[2]=m("option",{value:"",disabled:"",selected:""},"Вариации",-1)),(s(!0),c(M,null,ae((x=(V=e.node)==null?void 0:V.variations)==null?void 0:x.nodes,a=>{var w,Y;return s(),c("option",{key:a.databaseId,value:a.databaseId,selected:l(C)===a.databaseId},[(Y=(w=a.attributes)==null?void 0:w.nodes)!=null&&Y.length?(s(),c(M,{key:0},[te(R(a.attributes.nodes.map(ge=>ge.value).filter(Boolean).join(" / ")),1)],64)):(s(),c(M,{key:1},[te(R(a.name),1)],64))],8,Le)}),128))],32)])):f("",!0)]),l(P)?(s(),c("div",Me,R(l(P)),1)):f("",!0),l(re)?(s(),c("div",Ue,[m("div",Ae,[m("div",Ee,[m("button",{onClick:F(ce,["prevent"]),type:"button",class:"flex items-center justify-center w-6 h-full text-xs text-gray-500 transition-colors border-r border-gray-300 hover:bg-gray-50",disabled:l(_)<=1},[z(q,{name:"ion:remove",size:"14"})],8,Fe),be(m("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>_e(_)?_.value=a:null),type:"number",min:"1",class:"w-8 h-full text-xs text-center bg-transparent focus:outline-none"},null,512),[[ye,l(_),void 0,{number:!0}]]),m("button",{onClick:F(de,["prevent"]),type:"button",class:"flex items-center justify-center w-6 h-full text-xs text-gray-500 transition-colors border-l border-gray-300 hover:bg-gray-50"},[z(q,{name:"ion:add",size:"14"})])]),m("button",{onClick:F(me,["prevent"]),type:"button",disabled:l(ie),class:"flex items-center justify-center flex-1 h-8 px-3 text-xs font-medium text-white transition-colors bg-gray-800 rounded-md hover:bg-gray-900 disabled:bg-gray-400 disabled:cursor-not-allowed"},[t[3]||(t[3]=m("span",null,"Купи",-1)),l(W)?(s(),S(E,{key:0,stroke:"3",size:"10",color:"#fff",class:"ml-1"})):f("",!0)],8,Oe)])])):f("",!0)])])}}}),Ke=Object.assign(O(Qe,[["__scopeId","data-v-aaa5f5f1"]]),{__name:"ProductCardDetailed"});export{Ke as _,Be as a,Te as b};
