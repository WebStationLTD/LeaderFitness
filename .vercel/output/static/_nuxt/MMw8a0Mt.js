import{d as A,W as se,m as oe,A as u,c as r,i as h,a,o as s,t as j,v as O,a7 as he,h as P,_ as Q,F as U,r as ae,b as B,a6 as pe,X as fe,u as be,B as S,I as Z,e as c,w as ee,g as te,Q as ve,j as F,R as ye,T as _e,f as xe,k as we}from"./86dFGjsn.js";import{_ as ke}from"./TQp3UGqg.js";import{_ as Ie}from"./BOC87lRb.js";import{a as ne}from"./CqKe_Vxy.js";const Pe={key:0,class:"red-badge"},Ce=A({__name:"SaleBadge",props:{node:{type:Object,required:!0}},setup(e){const{t:p}=se(),{storeSettings:f}=oe(),_=u(()=>{var x,m,$,z;if(!((x=e.node)!=null&&x.rawSalePrice)||!((m=e.node)!=null&&m.rawRegularPrice))return"";const l=parseFloat(($=e.node)==null?void 0:$.rawSalePrice),d=parseFloat((z=e.node)==null?void 0:z.rawRegularPrice);return Math.round((l-d)/d*100)+" %"}),i=u(()=>e.node.rawSalePrice&&f.saleBadge!=="hidden"),C=u(()=>(f==null?void 0:f.saleBadge)==="percent"?_.value:p("messages.shop.onSale")?p("messages.shop.onSale"):"Sale");return(l,d)=>a(i)?(s(),r("span",Pe,j(a(C)),1)):h("",!0)}}),Se=Object.assign(O(Ce,[["__scopeId","data-v-c1bcf961"]]),{__name:"SaleBadge"}),Be=["title"],je=A({__name:"ProductWishlistButton",props:{product:{}},setup(e){const{addToWishlist:p,removeFromWishlist:f,isInList:_}=he(),i=e,C=u(()=>i.product.databaseId?_(i.product.databaseId):!1),l=d=>{d.preventDefault(),d.stopPropagation(),C.value&&i.product.databaseId?f(i.product.databaseId):p(i.product)};return(d,x)=>{const m=Q;return s(),r("button",{type:"button",class:"absolute top-2 left-2 z-40 bg-white/80 hover:bg-white rounded-full shadow-md transition-all duration-200 wishlist-btn",onClick:l,title:a(C)?d.$t("messages.shop.wishlistRemove"):d.$t("messages.shop.wishlistAdd")},[a(C)?(s(),P(m,{key:0,name:"ion:heart",size:"24",class:"text-red-500 md:w-6 md:h-6 w-5 h-5"})):(s(),P(m,{key:1,name:"ion:heart-outline",size:"24",class:"text-gray-600 md:w-6 md:h-6 w-5 h-5"}))],8,Be)}}}),$e=Object.assign(O(je,[["__scopeId","data-v-097c071d"]]),{__name:"ProductWishlistButton"}),ze={class:"inline-flex items-center"},Re={key:0,class:"text-xs ml-1 text-gray-500"},Ne=A({__name:"StarRating",props:{rating:{type:Number,default:0},count:{type:Number,default:null},hideCount:{type:Boolean,default:!1},size:{type:Number,default:14}},setup(e){return(p,f)=>{const _=Q;return s(),r("div",ze,[(s(),r(U,null,ae(5,i=>B(_,{key:i,name:"ion:star",size:e.size+"",class:"mr-[2px]",style:pe({color:e.rating<i?"#ccc":"#FBBE24"})},null,8,["size","style"])),64)),e.count!==null&&!e.hideCount?(s(),r("span",Re,"("+j(e.count)+")",1)):h("",!0)])}}}),Te=Object.assign(Ne,{__name:"StarRating"}),Ve={class:"relative group"},We={class:"mb-2 font-light leading-tight group-hover:text-primary"},qe={class:"flex flex-col items-start sm:flex-row sm:items-center sm:justify-between mb-3 min-h-[26px]"},Le={key:0,class:"flex w-full mt-2 sm:mt-0 sm:justify-end sm:w-[100px]"},Me=["value","selected"],Ue={key:2,class:"text-red-500 text-xs -mt-2 mb-3"},Ae={key:3},De={class:"flex items-center justify-between space-x-2"},Ee={class:"flex items-center h-8 bg-white border border-gray-300 rounded-md"},Fe=["disabled"],Oe=["disabled"],M=280,Qe=A({__name:"ProductCard",props:{node:{type:Object,required:!0},index:{type:Number,default:1}},setup(e){var X,G,J,K;const p=fe(),{storeSettings:f}=oe(),{addToCart:_,cart:i}=be(),{t:C}=se(),l=e,d=Math.round(M*1.125),x=S((X=p.query)==null?void 0:X.filter),m=S(((K=(J=(G=x.value)==null?void 0:G.split("pa_color[")[1])==null?void 0:J.split("]")[0])==null?void 0:K.split(","))||[]);Z(()=>p.query,()=>{var n,t,g;x.value=p.query.filter,m.value=((g=(t=(n=x.value)==null?void 0:n.split("pa_color[")[1])==null?void 0:t.split("]")[0])==null?void 0:g.split(","))||[]});const $=u(()=>{var n,t,g,k;return((t=(n=l.node)==null?void 0:n.image)==null?void 0:t.producCardSourceUrl)||((k=(g=l.node)==null?void 0:g.image)==null?void 0:k.sourceUrl)||"/images/placeholder.jpg"}),z=u(()=>{var n,t,g,k,W,T;if(m.value.length){const I=(t=(n=l.node)==null?void 0:n.variations)==null?void 0:t.nodes.filter(q=>{var V;const L=(V=q.attributes)==null?void 0:V.nodes.some(v=>m.value.some(o=>{var y;return(y=v==null?void 0:v.value)==null?void 0:y.includes(o)})),E=m.value.some(v=>{var o;return(o=q.slug)==null?void 0:o.includes(v)});return L||E});if(I!=null&&I.length)return((k=(g=I[0])==null?void 0:g.image)==null?void 0:k.producCardSourceUrl)||((T=(W=I[0])==null?void 0:W.image)==null?void 0:T.sourceUrl)||$.value}return $.value}),R=S(!1),b=S(1),w=S(""),N=S(null),H=u(()=>{var n;return((n=l.node)==null?void 0:n.type)===ne.VARIABLE}),le=u(()=>{var n;return((n=l.node)==null?void 0:n.type)===ne.SIMPLE}),D=u(()=>{var n,t;return H.value&&((t=(n=l.node)==null?void 0:n.variations)==null?void 0:t.nodes)&&l.node.variations.nodes.length>0}),re=u(()=>H.value||le.value),ie=u(()=>R.value||D.value&&!N.value),ce=()=>b.value++,de=()=>{b.value>1&&b.value--},ue=n=>{N.value=n,w.value=""},me=async()=>{var n;if((n=l.node)!=null&&n.databaseId){if(D.value&&!N.value){w.value="Моля, изберете вариация";return}R.value=!0,w.value="";try{const t={productId:l.node.databaseId,quantity:b.value,variationId:N.value};await _(t)}catch(t){console.error("Грешка при добавяне в количката:",t),w.value="Възникна грешка при добавяне в количката"}finally{setTimeout(()=>{R.value=!1},500)}}};return Z(i,()=>{setTimeout(()=>{R.value=!1,w.value=""},300)}),(n,t)=>{var V,v;const g=Se,k=$e,W=ke,T=xe,I=Te,q=Ie,L=Q,E=we;return s(),r("div",Ve,[e.node.slug?(s(),P(T,{key:0,to:`/produkt/${decodeURIComponent(e.node.slug)}`,title:e.node.name},{default:ee(()=>{var o,y;return[B(g,{node:e.node,class:"absolute top-2 right-2"},null,8,["node"]),B(k,{product:e.node},null,8,["product"]),a(z)?(s(),P(W,{key:0,width:M,height:a(d),src:a(z),alt:((o=e.node.image)==null?void 0:o.altText)||e.node.name||"Product image",title:((y=e.node.image)==null?void 0:y.title)||e.node.name,loading:e.index<=3?"eager":"lazy",sizes:`sm:${M/2}px md:${M}px`,class:"rounded-lg object-top object-cover w-full aspect-9/8",placeholder:"","placeholder-class":"blur-xl"},null,8,["height","src","alt","title","loading","sizes"])):h("",!0)]}),_:1},8,["to","title"])):h("",!0),c("div",null,[a(f).showReviews?(s(),P(I,{key:0,rating:e.node.averageRating||0,count:e.node.reviewCount||0},null,8,["rating","count"])):h("",!0),e.node.slug?(s(),P(T,{key:1,to:`/produkt/${decodeURIComponent(e.node.slug)}`,title:e.node.name},{default:ee(()=>[c("h2",We,j(e.node.name),1)]),_:1},8,["to","title"])):h("",!0),c("div",qe,[B(q,{class:"text-sm","sale-price":e.node.salePrice,"regular-price":e.node.regularPrice},null,8,["sale-price","regular-price"]),a(D)?(s(),r("div",Le,[c("select",{class:"text-xs py-1 px-2 border border-gray-300 rounded focus:outline-none focus:border-gray-400 bg-white w-full sm:max-w-[160px]",onChange:t[0]||(t[0]=o=>ue(Number(o.target.value)))},[t[2]||(t[2]=c("option",{value:"",disabled:"",selected:""},"Вариации",-1)),(s(!0),r(U,null,ae((v=(V=e.node)==null?void 0:V.variations)==null?void 0:v.nodes,o=>{var y,Y;return s(),r("option",{key:o.databaseId,value:o.databaseId,selected:a(N)===o.databaseId},[(Y=(y=o.attributes)==null?void 0:y.nodes)!=null&&Y.length?(s(),r(U,{key:0},[te(j(o.attributes.nodes.map(ge=>ge.value).filter(Boolean).join(" / ")),1)],64)):(s(),r(U,{key:1},[te(j(o.name),1)],64))],8,Me)}),128))],32)])):h("",!0)]),a(w)?(s(),r("div",Ue,j(a(w)),1)):h("",!0),a(re)?(s(),r("div",Ae,[c("div",De,[c("div",Ee,[c("button",{onClick:F(de,["prevent"]),type:"button",class:"flex items-center justify-center w-6 h-full text-xs text-gray-500 transition-colors border-r border-gray-300 hover:bg-gray-50",disabled:a(b)<=1},[B(L,{name:"ion:remove",size:"14"})],8,Fe),ve(c("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>_e(b)?b.value=o:null),type:"number",min:"1",class:"w-8 h-full text-xs text-center bg-transparent focus:outline-none"},null,512),[[ye,a(b),void 0,{number:!0}]]),c("button",{onClick:F(ce,["prevent"]),type:"button",class:"flex items-center justify-center w-6 h-full text-xs text-gray-500 transition-colors border-l border-gray-300 hover:bg-gray-50"},[B(L,{name:"ion:add",size:"14"})])]),c("button",{onClick:F(me,["prevent"]),type:"button",disabled:a(ie),class:"flex items-center justify-center flex-1 h-8 px-3 text-xs font-medium text-white transition-colors bg-gray-800 rounded-md hover:bg-gray-900 disabled:bg-gray-400 disabled:cursor-not-allowed"},[t[3]||(t[3]=c("span",null,"Купи",-1)),a(R)?(s(),P(E,{key:0,stroke:"3",size:"10",color:"#fff",class:"ml-1"})):h("",!0)],8,Oe)])])):h("",!0)])])}}}),Ke=Object.assign(O(Qe,[["__scopeId","data-v-b7c75a14"]]),{__name:"ProductCard"});export{Ke as _,Se as a,Te as b};
