import{d as z,p as H,X as W,N as G,m as Q,A as y,c,i as l,a as e,o as a,e as n,F as X,r as Z,h,f as J,w as E,_ as B,t as p,S as Y,W as C,B as R,I as ee,b as A,s as se,Q as O,R as D,U as S,g as T,Z as oe,k as te,j as re,v as ae}from"./C9ZPaObW.js";import{L as ne}from"./DShf2aAB.js";import{_ as ie}from"./COb_tIt_.js";const le={key:0},ce={key:2},ue={class:"flex items-center justify-center gap-4 my-8 leading-none"},me={class:"text-gray-400"},de=z({__name:"LoginProviders",setup(K){const{loginClients:r,loginWithProvider:x}=H(),b=W(),j=G(),{storeSettings:k}=Q(),{provider:L,code:P,state:g}=b.query;P&&g&&L&&x(g,P,L.toUpperCase()).then(()=>{j.replace({query:{}})}).catch(m=>{console.error("Login failed:",m)});const o={FACEBOOK:"ion:logo-facebook",GITHUB:"ion:logo-github",GOOGLE:"ion:logo-google",INSTAGRAM:"ion:logo-instagram",LINKEDIN:"ion:logo-linkedin"},_=(k==null?void 0:k.socialLoginsDisplay)||"buttons",u=y(()=>{var m;return((m=r.value)==null?void 0:m.filter(f=>(f==null?void 0:f.provider)!==ne.PASSWORD))||[]}),F=m=>m?`Login with ${m.charAt(0).toUpperCase()+m.slice(1).toLowerCase()}`:"Login";return(m,f)=>{var $;const V=B,w=B,M=J;return($=e(u))!=null&&$.length?(a(),c("div",le,[n("div",{class:Y(["gap-4",e(_)==="buttons"?"grid gap-4 grid-cols-[repeat(auto-fit,minmax(180px,1fr))] justify-center":" flex gap-4 flex-wrap justify-center"])},[(a(!0),c(X,null,Z(e(u),(d,U)=>(a(),c("div",{key:U},[d&&(d!=null&&d.authorizationUrl)?(a(),h(M,{key:0,to:d==null?void 0:d.authorizationUrl,class:"flex items-center justify-center gap-3 p-3 bg-white rounded-lg shadow-sm hover:shadow transition duration-100 ease-in-out"},{default:E(()=>[d.provider?(a(),h(V,{key:0,name:o[d.provider],size:"20"},null,8,["name"])):(a(),h(w,{key:1,name:"ion:log-in",size:"20"})),e(_)==="buttons"?(a(),c("span",ce,p(d.name||F(d.provider)),1)):l("",!0)]),_:2},1032,["to"])):l("",!0)]))),128))],2),n("div",ue,[f[0]||(f[0]=n("div",{class:"border-b w-1/3 flex-1"},null,-1)),n("div",me,p(m.$t("messages.account.orContinueWithEmail")),1),f[1]||(f[1]=n("div",{class:"border-b w-1/3 flex-1"},null,-1))])])):l("",!0)}}}),ge=Object.assign(de,{__name:"LoginProviders"}),pe={class:"max-w-lg mx-auto my-16 min-h-[600px] text-center"},fe={class:"flex flex-col my-2"},_e={class:"text-xl font-semibold lg:text-3xl"},ve={key:0,for:"email"},ye=["placeholder"],we={key:1,class:"text-sm text-gray-500"},xe={key:2},be=["placeholder"],ke=["innerHTML"],he=["innerHTML"],Le={class:"flex items-center justify-between mt-4"},Pe={class:"flex items-center gap-2"},$e={class:"flex items-center justify-center gap-4 my-6 text-lg"},Ue={key:1,class:"my-6 text-center"},Re={key:2,class:"my-2 text-center justify-center"},Ae=z({__name:"LoginAndRegister",setup(K){const{t:r}=C(),x=W(),b=G(),{loginUser:j,isPending:k,registerUser:L,sendResetPasswordEmail:P}=H(),g=R({email:"",password:"",username:"",rememberMe:!1}),o=R("login"),_=R(""),u=R("");ee(x,()=>{x.query.action==="forgotPassword"?o.value="forgotPassword":x.query.action==="register"?o.value="register":o.value="login"},{immediate:!0});const m=async t=>{const{success:s,error:v}=await j(t);switch(v){case"invalid_username":u.value=r("messages.error.invalidUsername");break;case"incorrect_password":u.value=r("messages.error.incorrectPassword");break;default:u.value=v;break}s&&(u.value="",_.value=r("messages.account.loggingIn"))},f=async t=>{if(o.value==="register"){const{email:s,password:v,username:I}=t,q={email:s,password:v,username:I},{success:N,error:i}=await L(q);N?(u.value="",_.value=r("messages.account.accountCreated")+" "+r("messages.account.loggingIn"),setTimeout(()=>{m(t)},2e3)):u.value=i}else o.value==="forgotPassword"?V(t):m(t)},V=async t=>{const{success:s,error:v}=await P({username:t.email});s?(u.value="",_.value=r("messages.account.ifRegistered")):u.value=v},w=t=>{o.value=t,t==="forgotPassword"?b.push({query:{action:"forgotPassword"}}):t==="register"?b.push({query:{action:"register"}}):b.push({query:{}})},M=y(()=>{if(o.value==="login")return r("messages.account.loginToAccount");if(o.value==="register")return r("messages.account.accountRegister");if(o.value==="forgotPassword")return r("messages.account.forgotPassword")}),$=y(()=>{if(o.value==="login")return r("messages.account.login");if(o.value==="register")return r("messages.account.register");if(o.value==="forgotPassword")return r("messages.account.sendPasswordResetEmail")});y(()=>o.value==="register"?r("messages.billing.email"):r("messages.account.emailOrUsername")),y(()=>o.value==="login"?r("messages.account.emailOrUsername"):r("messages.account.username"));const d=y(()=>r("messages.account.password")),U=y(()=>({email:"johndoe@email.com",username:o.value==="login"?"johndoe@email.com":"johndoe",password:"********"}));return(t,s)=>{const v=se,I=ge,q=ie,N=te;return a(),c("div",pe,[A(v),n("div",fe,[n("h1",_e,p(e(M)),1),s[9]||(s[9]=n("p",{class:"text-gray-500 mt-2"},"Welcome back! Select method to login.",-1))]),e(o)==="login"||e(o)==="register"?(a(),h(I,{key:0,class:"my-8"})):l("",!0),n("form",{class:"mt-6",onSubmit:s[5]||(s[5]=re(i=>f(e(g)),["prevent"]))},[e(o)==="register"||e(o)==="forgotPassword"?(a(),c("div",ve,[O(n("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=i=>e(g).email=i),placeholder:e(U).email,autocomplete:"email",type:"text",required:""},null,8,ye),[[D,e(g).email]])])):l("",!0),e(o)==="forgotPassword"?(a(),c("p",we,p(t.$t("messages.account.enterEmailOrUsernameForReset")),1)):l("",!0),e(o)!=="forgotPassword"?(a(),c("div",xe,[O(n("input",{class:"mt-1","onUpdate:modelValue":s[1]||(s[1]=i=>e(g).username=i),placeholder:e(U).username,autocomplete:"username",type:"text",required:""},null,8,be),[[D,e(g).username]]),A(q,{className:"border rounded-lg w-full p-3 px-4 bg-white mt-1",modelValue:e(g).password,"onUpdate:modelValue":s[2]||(s[2]=i=>e(g).password=i),placeholder:e(d),autocomplete:e(o)==="login"?"current-password":"new-password",required:!0},null,8,["modelValue","placeholder","autocomplete"])])):l("",!0),A(S,{name:"scale-y",mode:"out-in"},{default:E(()=>[e(_)?(a(),c("div",{key:0,class:"my-4 text-sm text-green-500",innerHTML:e(_)},null,8,ke)):l("",!0)]),_:1}),A(S,{name:"scale-y",mode:"out-in"},{default:E(()=>[e(u)?(a(),c("div",{key:0,class:"my-4 text-sm text-red-500",innerHTML:e(u)},null,8,he)):l("",!0)]),_:1}),n("div",Le,[n("label",Pe,[O(n("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>e(g).rememberMe=i),type:"checkbox"},null,512),[[oe,e(g).rememberMe]]),s[10]||(s[10]=T("Remember me "))]),e(o)==="login"?(a(),c("div",{key:0,class:"font-semibold cursor-pointer text-sm text-primary hover:text-primary",onClick:s[4]||(s[4]=i=>w("forgotPassword"))}," Forgot password? ")):l("",!0)]),n("button",$e,[e(k)?(a(),h(N,{key:0,stroke:"4",size:"16",color:"#fff"})):l("",!0),n("span",null,p(e($)),1)])],32),e(o)==="login"?(a(),c("div",Ue,[T(p(t.$t("messages.account.noAccount"))+" ",1),n("a",{class:"font-semibold cursor-pointer text-primary",onClick:s[6]||(s[6]=i=>w("register"))},p(t.$t("messages.account.accountRegister")),1),s[11]||(s[11]=T(". "))])):l("",!0),e(o)==="register"?(a(),c("div",Re,[T(p(t.$t("messages.account.hasAccount"))+" ",1),n("a",{class:"font-semibold cursor-pointer text-primary",onClick:s[7]||(s[7]=i=>w("login"))},p(t.$t("messages.general.please"))+" "+p(t.$t("messages.account.accountLogin")),1)])):l("",!0),e(o)==="forgotPassword"?(a(),c("div",{key:3,class:"my-8 text-center cursor-pointer",onClick:s[8]||(s[8]=i=>w("login"))},p(t.$t("messages.account.backToLogin")),1)):l("",!0)])}}}),Me=Object.assign(ae(Ae,[["__scopeId","data-v-48dd173d"]]),{__name:"LoginAndRegister"});export{Me as default};
