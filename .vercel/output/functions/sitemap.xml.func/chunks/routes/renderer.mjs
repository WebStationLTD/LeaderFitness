import{getRequestDependencies as e,getPreloadLinks as t,getPrefetchLinks as r}from"vue-bundle-renderer/runtime";import{g as o,a as s,b as n,d as a,c as d,e as i,f as l,h as p,i as u,j as h,k as c,l as m,m as y,s as f,n as g,o as _,q as b,r as x,v as C,u as A}from"../_/nitro.mjs";import{stringify as j,uneval as w}from"devalue";import{propsToString as T,renderSSRHead as k}from"unhead/server";import"node:http";import"node:https";import"node:events";import"node:buffer";import"vue";import"graphql-request";import"consola";import"@iconify/utils";import"node:crypto";import"unhead/plugins";import"unhead/utils";import"vue/server-renderer";import"node:url";import"ipx";import"node:fs";import"node:path";function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?j(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":n,"data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${w(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:r,...o}=e.payload;return{initial:{...o,prerenderedAt:r},payload:{data:t,prerenderedAt:r}}}const v={omitLineBreaks:!0};globalThis.__buildAssetsURL=d,globalThis.__publicAssetsURL=i;const R=!!p.id,$=R?`<${l}${T(p)}>`:"",P=R?`</${l}>`:"",S=/^[^?]*\/_payload.json(?:\?.*)?$/,L=a((async n=>{const a=A(),i=n.path.startsWith("/__nuxt_error")?u(n):null;if(i&&!("__unenv__"in n.node.req))throw h({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const l=c(n),w={mode:"server"};if(l.head.push(m,w),i){if(i.statusCode&&=Number.parseInt(i.statusCode),"string"==typeof i.data)try{i.data=y(i.data)}catch{}f(l,i)}const T=S.test(l.url);if(T){const e=l.url.substring(0,l.url.lastIndexOf("/"))||"/";l.url=e,n._path=n.node.req.url=e}const L=g(n);!1===L.ssr&&(l.noSSR=!0);const N=await _(l);for(const e of await b())l.modules.add(e);const U=await N.renderToString(l).catch((async e=>{if(l._renderResponse&&"skipping render"===e.message)return{};const t=!i&&l.payload?.error||e;throw await(l.nuxt?.hooks.callHook("app:error",t)),t})),M=l._renderResponse||T?[]:await x(l.modules??[]);if(await(l.nuxt?.hooks.callHook("app:rendered",{ssrContext:l,renderResult:U})),l._renderResponse)return l._renderResponse;if(l.payload?.error&&!i)throw l.payload.error;if(T){const e=function(e){return{body:j(splitPayload(e).payload,e._payloadReducers),statusCode:s(e.event),statusMessage:o(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(l);return e}const q=L.noScripts,{styles:H,scripts:O}=e(l,N.rendererContext);l._preloadManifest&&!q&&l.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:d(`builds/meta/${l.runtimeConfig.app.buildId}.json`)}]},{...w,tagPriority:"low"}),M.length&&l.head.push({style:M});const z=[];for(const e of Object.values(H))z.push({rel:"stylesheet",href:N.rendererContext.buildAssetsURL(e.file),crossorigin:""});z.length&&l.head.push({link:z},w),q||(l.head.push({link:t(l,N.rendererContext)},w),l.head.push({link:r(l,N.rendererContext)},w),l.head.push({script:renderPayloadJsonScript({ssrContext:l,data:l.payload})},{...w,tagPosition:"bodyClose",tagPriority:"high"})),L.noScripts||l.head.push({script:Object.values(O).map((e=>({type:e.module?"module":null,src:N.rendererContext.buildAssetsURL(e.file),defer:!e.module||null,tagPosition:"head",crossorigin:""})))},w);const{headTags:I,bodyTags:X,bodyTagsOpen:B,htmlAttrs:D,bodyAttrs:J}=await k(l.head,v),E={htmlAttrs:D?[D]:[],head:normalizeChunks([I]),bodyAttrs:J?[J]:[],bodyPrepend:normalizeChunks([B,l.teleports?.body]),body:[C(l,U.html),$+(R?joinTags([l.teleports?.[`#${p.id}`]]):"")+P],bodyAppend:[X]};return await a.hooks.callHook("render:html",E,{event:n}),{body:(F=E,`<!DOCTYPE html><html${joinAttrs(F.htmlAttrs)}><head>${joinTags(F.head)}</head><body${joinAttrs(F.bodyAttrs)}>${joinTags(F.bodyPrepend)}${joinTags(F.body)}${joinTags(F.bodyAppend)}</body></html>`),statusCode:s(n),statusMessage:o(n),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var F}));function normalizeChunks(e){return e.filter(Boolean).map((e=>e.trim()))}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}export{L as default};
//# sourceMappingURL=renderer.mjs.map
