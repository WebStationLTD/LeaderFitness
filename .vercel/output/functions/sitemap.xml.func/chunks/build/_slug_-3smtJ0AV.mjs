import{_ as e,a as o,b as r,c as l,d as t}from"./ProductGrid-DY9nXRDO.mjs";import{defineComponent as a,ref as s,withAsyncContext as i,computed as u,watch as n,mergeProps as p,unref as d,useSSRContext as m}from"vue";import{ssrRenderAttrs as c,ssrRenderComponent as v}from"vue/server-renderer";import{z as g,e as y,d as h,w as f,i as x,l as k}from"./server.mjs";import"./default-C7s0JCB3.mjs";import"graphql-request";import"./ProductCardDetailed-rUiUyB7s.mjs";import"./NuxtImg-BJG_EbHe.mjs";import"./ProductPrice-BLA-t2Nu.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"consola";import"@iconify/utils";import"node:crypto";import"node:url";import"ipx";import"node:fs";import"node:path";import"vue-router";import"@iconify/vue";import"@heroicons/vue/24/outline";import"@iconify/utils/lib/css/icon";import"@headlessui/vue";import"@heroicons/vue/20/solid";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";const w=a({__name:"[slug]",__ssrInlineRender:!0,async setup(a){var m,w,P,j,q,S,b,_,C,D,B,L,M,R,U,F;let I,A;const{updateProductList:T,products:G}=g();y();const{storeSettings:H}=h(),J=f(),N=s(!0);console.log("Текущ route:",{fullPath:J.fullPath,path:J.path,name:J.name,params:J.params});let O="";if(J.params&&J.params.categorySlug&&(O="string"==typeof J.params.categorySlug?J.params.categorySlug:String(J.params.categorySlug)),!O&&J.params&&J.params.slug&&(O="string"==typeof J.params.slug?J.params.slug:String(J.params.slug)),!O&&J.path){const e=J.path.split("/"),o=e.findIndex((e=>"produkt-kategoriya"===e));if(-1!==o&&e[o+1]&&"page"!==e[o+1]){const r=e[o+1];r&&(O=r)}}console.log("Извлечен slug:",O),O?console.log("Slug от URL (преди декодиране):",O):console.log("Използваме всички продукти, тъй като slug е празен");let $=O;try{O&&($=decodeURIComponent(O),console.log("Декодиран slug:",$))}catch(e){console.error("Грешка при декодиране на URL:",e)}const z=s(O),E=s(null),X=s(""),Y=s(""),{data:K}=([I,A]=i((()=>x("getProductCategories"))),I=await I,A(),I),Q=u((()=>{var e,o;return(null==(o=null==(e=K.value)?void 0:e.productCategories)?void 0:o.nodes)||[]}));return z.value&&(E.value=Q.value.find((e=>e.slug&&(e.slug===z.value||e.slug===$)))||null,console.log("Намерена категория:",E.value)),z.value,J.query.search,J.query.priceMin&&parseFloat(J.query.priceMin),J.query.priceMax&&parseFloat(J.query.priceMax),J.query.sale,J.query.orderby,setTimeout((()=>{N.value=!1}),500),n((()=>J.query),(()=>{"produkt-kategoriya-slug"!==J.name&&"produkt-kategoriya-page-pager"!==J.name||T()})),n((()=>J.params),(()=>{"produkt-kategoriya-slug"!==J.name&&"produkt-kategoriya-page-pager"!==J.name||T()})),X.value=(null==(w=null==(m=E.value)?void 0:m.seo)?void 0:w.title)||(null==(P=E.value)?void 0:P.name)||$||"All Products",Y.value=(null==(q=null==(j=E.value)?void 0:j.seo)?void 0:q.metaDesc)||(null==(S=E.value)?void 0:S.description)||`Products in category ${(null==(b=E.value)?void 0:b.name)||$||"All Products"}`,k({title:X.value,meta:[{name:"description",content:Y.value},{property:"og:title",content:(null==(C=null==(_=E.value)?void 0:_.seo)?void 0:C.opengraphTitle)||X.value},{property:"og:description",content:(null==(B=null==(D=E.value)?void 0:D.seo)?void 0:B.opengraphDescription)||Y.value}],link:[{rel:"canonical",href:(null==(M=null==(L=E.value)?void 0:L.seo)?void 0:M.canonical)||""}]}),(null==(F=null==(U=null==(R=E.value)?void 0:R.seo)?void 0:U.schema)?void 0:F.raw)&&k({script:[{type:"application/ld+json",innerHTML:E.value.seo.schema.raw}]}),(a,s,i,u)=>{var n;const m=e,g=o,y=r,h=l,f=t;s(`<div${c(p({class:"container px-2"},u))}>`),null==(n=d(G))||n.length,s('<div class="flex items-start gap-16">'),d(H).showFilters?s(v(m,{"hide-categories":!0},null,i)):s("\x3c!----\x3e"),s('<div class="w-full"><div class="flex items-center justify-between w-full gap-4 mt-8 md:gap-8">'),s(v(g,null,null,i)),d(H).showOrderByDropdown?s(v(y,{class:"hidden md:inline-flex"},null,i)):s("\x3c!----\x3e"),d(H).showFilters?s(v(h,{class:"md:hidden"},null,i)):s("\x3c!----\x3e"),s("</div>"),s(v(f,null,null,i)),s("</div></div>"),s("</div>")}}}),P=w.setup;w.setup=(e,o)=>{const r=m();return(r.modules||(r.modules=new Set)).add("woonuxt_base/app/pages/produkt-kategoriya/[slug].vue"),P?P(e,o):void 0};export{w as default};
//# sourceMappingURL=_slug_-3smtJ0AV.mjs.map
