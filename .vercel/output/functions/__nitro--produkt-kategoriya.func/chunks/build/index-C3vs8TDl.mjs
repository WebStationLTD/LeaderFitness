import{m as e,j as t,c as s,i as a}from"./server.mjs";import{defineComponent as o,withAsyncContext as r,mergeProps as i,unref as d,ref as u,reactive as c,withCtx as p,createVNode as v,createBlock as g,openBlock as x,createCommentVNode as f,toDisplayString as h,createTextVNode as y,Fragment as b,renderList as $,useSSRContext as w}from"vue";import{ssrRenderAttrs as I,ssrInterpolate as _,ssrRenderList as j,ssrRenderComponent as k,ssrRenderAttr as B,ssrIncludeBooleanAttr as C}from"vue/server-renderer";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"graphql-request";import"consola";import"@iconify/utils";import"node:crypto";import"node:url";import"ipx";import"node:fs";import"node:path";import"vue-router";import"@iconify/vue";import"@heroicons/vue/24/outline";import"@iconify/utils/lib/css/icon";import"@headlessui/vue";import"@heroicons/vue/20/solid";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";const G=o({__name:"BlogPostCard",__ssrInlineRender:!0,props:{post:{type:Object,required:!0}},setup(e){const n=e=>{if(!e)return"";const t=new Date(e);return new Intl.DateTimeFormat("bg-BG",{year:"numeric",month:"long",day:"numeric"}).format(t)},l=e=>{if(!e)return"";const t=e.replace(/<\/?[^>]+(>|$)/g,"").replace(/\[&hellip;\]|\[…\]/g,"...");return t.length>150?t.slice(0,150)+"...":t};return(t,s,o,r)=>{const d=a;s(`<article${I(i({class:"flex flex-col overflow-hidden rounded-lg shadow transition-all hover:shadow-lg"},r))} data-v-c2845411>`),s(k(d,{to:`/blog/${e.post.slug}`,class:"block overflow-hidden"},{default:p(((t,s,a,o)=>{var r,i,d,u,c,p,w,I,k,C,G,N;if(!s)return[v("div",{class:"aspect-w-16 aspect-h-9 w-full relative"},[null!=(I=null==(w=e.post.featuredImage)?void 0:w.node)&&I.sourceUrl?(x(),g("img",{key:0,src:e.post.featuredImage.node.sourceUrl,alt:e.post.featuredImage.node.altText||e.post.title,class:"h-48 w-full object-cover transition-transform duration-200 ease-in-out hover:scale-105"},null,8,["src","alt"])):(x(),g("div",{key:1,class:"h-48 w-full bg-gray-200 flex items-center justify-center"},[v("span",{class:"text-gray-400"},"Няма изображение")]))]),v("div",{class:"flex-1 bg-white p-6 flex flex-col justify-between"},[v("div",{class:"flex-1"},[v("div",{class:"flex items-center gap-2 text-sm text-gray-500 mb-2"},[e.post.date?(x(),g("time",{key:0,datetime:e.post.date},h(n(e.post.date)),9,["datetime"])):f("",!0),null!=(C=null==(k=e.post.categories)?void 0:k.nodes)&&C.length?(x(),g("span",{key:1,class:"inline-flex"},[y(" • "),(x(!0),g(b,null,$(e.post.categories.nodes,((t,s)=>(x(),g("span",{key:t.slug,class:"ml-1"},h(t.name)+h(s<e.post.categories.nodes.length-1?", ":""),1)))),128))])):f("",!0)]),v("h3",{class:"text-xl font-semibold text-gray-900 hover:text-primary-600"},h(e.post.title),1),e.post.excerpt?(x(),g("div",{key:0,class:"mt-3 text-gray-600"},h(l(e.post.excerpt)),1)):f("",!0)]),v("div",{class:"mt-4"},[null!=(G=e.post.author)&&G.node?(x(),g("div",{key:0,class:"flex items-center"},[null!=(N=e.post.author.node.avatar)&&N.url?(x(),g("div",{key:0,class:"flex-shrink-0 mr-2"},[v("img",{class:"h-8 w-8 rounded-full",src:e.post.author.node.avatar.url,alt:e.post.author.node.name},null,8,["src","alt"])])):f("",!0),e.post.author.node.name?(x(),g("p",{key:1,class:"text-sm font-medium text-gray-900"},h(e.post.author.node.name),1)):f("",!0)])):f("",!0)])])];s(`<div class="aspect-w-16 aspect-h-9 w-full relative" data-v-c2845411${o}>`),null!=(i=null==(r=e.post.featuredImage)?void 0:r.node)&&i.sourceUrl?s(`<img${B("src",e.post.featuredImage.node.sourceUrl)}${B("alt",e.post.featuredImage.node.altText||e.post.title)} class="h-48 w-full object-cover transition-transform duration-200 ease-in-out hover:scale-105" data-v-c2845411${o}>`):s(`<div class="h-48 w-full bg-gray-200 flex items-center justify-center" data-v-c2845411${o}><span class="text-gray-400" data-v-c2845411${o}>Няма изображение</span></div>`),s(`</div><div class="flex-1 bg-white p-6 flex flex-col justify-between" data-v-c2845411${o}><div class="flex-1" data-v-c2845411${o}><div class="flex items-center gap-2 text-sm text-gray-500 mb-2" data-v-c2845411${o}>`),e.post.date?s(`<time${B("datetime",e.post.date)} data-v-c2845411${o}>${_(n(e.post.date))}</time>`):s("\x3c!----\x3e"),null!=(u=null==(d=e.post.categories)?void 0:d.nodes)&&u.length?(s(`<span class="inline-flex" data-v-c2845411${o}> • \x3c!--[--\x3e`),j(e.post.categories.nodes,((t,a)=>{s(`<span class="ml-1" data-v-c2845411${o}>${_(t.name)}${_(a<e.post.categories.nodes.length-1?", ":"")}</span>`)})),s("\x3c!--]--\x3e</span>")):s("\x3c!----\x3e"),s(`</div><h3 class="text-xl font-semibold text-gray-900 hover:text-primary-600" data-v-c2845411${o}>${_(e.post.title)}</h3>`),e.post.excerpt?s(`<div class="mt-3 text-gray-600" data-v-c2845411${o}>${_(l(e.post.excerpt))}</div>`):s("\x3c!----\x3e"),s(`</div><div class="mt-4" data-v-c2845411${o}>`),null!=(c=e.post.author)&&c.node?(s(`<div class="flex items-center" data-v-c2845411${o}>`),null!=(p=e.post.author.node.avatar)&&p.url?s(`<div class="flex-shrink-0 mr-2" data-v-c2845411${o}><img class="h-8 w-8 rounded-full"${B("src",e.post.author.node.avatar.url)}${B("alt",e.post.author.node.name)} data-v-c2845411${o}></div>`):s("\x3c!----\x3e"),e.post.author.node.name?s(`<p class="text-sm font-medium text-gray-900" data-v-c2845411${o}>${_(e.post.author.node.name)}</p>`):s("\x3c!----\x3e"),s("</div>")):s("\x3c!----\x3e"),s("</div></div>")})),_:1},o)),s("</article>")}}}),N=G.setup;G.setup=(e,t)=>{const s=w();return(s.modules||(s.modules=new Set)).add("components/blog/BlogPostCard.vue"),N?N(e,t):void 0};const S=Object.assign(s(G,[["__scopeId","data-v-c2845411"]]),{__name:"BlogPostCard"}),z=()=>{const e=u([]),s=u(null),a=u(!1),o=u(null),r=c({hasNextPage:!1,endCursor:null}),m=t=>{t&&t.length>0&&(e.value=[...e.value,...t])},P=e=>{s.value=e};return{posts:e,currentPost:s,loading:a,error:o,pageInfo:r,setPosts:t=>{t&&t.length>0&&(e.value=t)},addPosts:m,setCurrentPost:P,loadMorePosts:async()=>{var e,s;if(r.hasNextPage){a.value=!0,o.value=null;try{const{data:a}=await t("GetBlogPosts",{first:12,after:r.endCursor});null!=(s=null==(e=a.value)?void 0:e.posts)&&s.nodes&&(m(a.value.posts.nodes),r.hasNextPage=a.value.posts.pageInfo.hasNextPage,r.endCursor=a.value.posts.pageInfo.endCursor)}catch(e){o.value=e.message||"Грешка при зареждане на публикации"}finally{a.value=!1}}},loadPostBySlug:async e=>{var s,r,i,d;a.value=!0,o.value=null;try{const{data:a}=await t("GetBlogPosts",{first:100}),o=null==(i=null==(r=null==(s=a.value)?void 0:s.posts)?void 0:r.nodes)?void 0:i.find((t=>t.slug===e));if(o){const{data:e}=await t("GetBlogPost",{id:o.id});if(null!=(d=e.value)&&d.post)return P(e.value.post),e.value.post}return null}catch(e){return o.value=e.message||"Грешка при зареждане на публикацията",null}finally{a.value=!1}}}},U=o({__name:"BlogPagination",__ssrInlineRender:!0,setup(e){const{loading:t,pageInfo:s}=z();return(e,a,o,r)=>{d(s).hasNextPage?(a(`<div${I(i({class:"w-full mt-8 flex justify-center"},r))}><button${C(d(t))?" disabled":""} class="rounded-lg px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed">`),d(t)?a("<span>Зареждане...</span>"):a("<span>Зареди още</span>"),a("</button></div>")):a("\x3c!----\x3e")}}}),q=U.setup;U.setup=(e,t)=>{const s=w();return(s.modules||(s.modules=new Set)).add("components/blog/BlogPagination.vue"),q?q(e,t):void 0};const L=Object.assign(U,{__name:"BlogPagination"}),O=o({__name:"index",__ssrInlineRender:!0,async setup(s){var a,o;let u,c;const{setPosts:p,posts:v,pageInfo:g}=z();let x="Блог";e({title:x,meta:[{name:"description",content:"Всички публикации от нашия блог"}]});try{const{data:e}=([u,c]=r((()=>t("GetBlogPosts",{first:50}))),u=await u,c(),u);null!=(o=null==(a=e.value)?void 0:a.posts)&&o.nodes&&(p(e.value.posts.nodes),e.value.posts.pageInfo&&(g.hasNextPage=e.value.posts.pageInfo.hasNextPage,g.endCursor=e.value.posts.pageInfo.endCursor))}catch(e){console.error("Грешка при зареждане на публикации:",e)}return(e,t,s,a)=>{const o=S,r=L;t(`<div${I(i({class:"container py-8"},a))}><h1 class="text-3xl sm:text-4xl font-bold text-center mb-8">${_(d(x))}</h1>`),d(v).length?(t('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">\x3c!--[--\x3e'),j(d(v),(e=>{t(k(o,{key:e.id,post:e},null,s))})),t("\x3c!--]--\x3e</div>")):t('<div class="text-center p-8"><h2 class="text-xl font-semibold">Няма намерени публикации</h2><p class="mt-2 text-gray-600">В момента няма публикации в блога</p><div class="mt-8 p-4 bg-yellow-50 rounded-lg text-left"><p class="font-semibold">Възможни причини:</p><ul class="list-disc pl-5 mt-2"><li>WPGraphQL плъгинът не е активиран</li><li>Публикациите (posts) не са достъпни през GraphQL API</li><li>Постовете са с неправилен статус (трябва да са published)</li><li>Има проблем с GraphQL ендпойнта или достъпа до него</li></ul></div></div>'),d(v).length&&d(g).hasNextPage?t(k(r,null,null,s)):t("\x3c!----\x3e"),t("</div>")}}}),Q=O.setup;O.setup=(e,t)=>{const s=w();return(s.modules||(s.modules=new Set)).add("pages/blog/index.vue"),Q?Q(e,t):void 0};export{O as default};
//# sourceMappingURL=index-C3vs8TDl.mjs.map
