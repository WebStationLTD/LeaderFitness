import{Z as e,e as o,q as r,_ as l,t}from"./ProductGrid-RH2QtqtY.mjs";import{defineComponent as a,ref as s,withAsyncContext as i,computed as u,watch as n,mergeProps as p,unref as d,useSSRContext as m}from"vue";import{ssrRenderAttrs as c,ssrRenderComponent as v}from"vue/server-renderer";import{A as g,d as y,f as h,x as f,j as x,m as k}from"./server.mjs";import"./default-3LCvtah8.mjs";import"graphql-request";import"./ProductCardDetailed-d2y59aH9.mjs";import"./NuxtImg-CriYuRni.mjs";import"./ProductPrice-D0-FECQf.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"consola";import"@iconify/utils";import"node:crypto";import"node:url";import"ipx";import"node:fs";import"node:path";import"vue-router";import"@iconify/vue";import"@heroicons/vue/24/outline";import"@iconify/utils/lib/css/icon";import"@headlessui/vue";import"@heroicons/vue/20/solid";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/plugins";import"unhead/utils";const w=a({__name:"[slug]",__ssrInlineRender:!0,async setup(a){var m,w,j,q,P,S,C,_,b,R,D,F,L,M,I,A;let H,T;const{updateProductList:U,products:Q}=g();y();const{storeSettings:Y}=h(),$=f(),B=s(!0);console.log("Текущ route:",{fullPath:$.fullPath,path:$.path,name:$.name,params:$.params});let E="";if($.params&&$.params.categorySlug&&(E="string"==typeof $.params.categorySlug?$.params.categorySlug:String($.params.categorySlug)),!E&&$.params&&$.params.slug&&(E="string"==typeof $.params.slug?$.params.slug:String($.params.slug)),!E&&$.path){const e=$.path.split("/"),o=e.findIndex((e=>"produkt-kategoriya"===e));if(-1!==o&&e[o+1]&&"page"!==e[o+1]){const r=e[o+1];r&&(E=r)}}console.log("Извлечен slug:",E),E?console.log("Slug от URL (преди декодиране):",E):console.log("Използваме всички продукти, тъй като slug е празен");let G=E;try{E&&(G=decodeURIComponent(E),console.log("Декодиран slug:",G))}catch(e){console.error("Грешка при декодиране на URL:",e)}const N=s(E),O=s(null),Z=s(""),z=s(""),{data:J}=([H,T]=i((()=>x("getProductCategories"))),H=await H,T(),H),K=u((()=>{var e,o;return(null==(o=null==(e=J.value)?void 0:e.productCategories)?void 0:o.nodes)||[]}));return N.value&&(O.value=K.value.find((e=>e.slug&&(e.slug===N.value||e.slug===G)))||null,console.log("Намерена категория:",O.value)),N.value,$.query.search,$.query.priceMin&&parseFloat($.query.priceMin),$.query.priceMax&&parseFloat($.query.priceMax),$.query.sale,$.query.orderby,setTimeout((()=>{B.value=!1}),500),n((()=>$.query),(()=>{"produkt-kategoriya-slug"!==$.name&&"produkt-kategoriya-page-pager"!==$.name||U()})),n((()=>$.params),(()=>{"produkt-kategoriya-slug"!==$.name&&"produkt-kategoriya-page-pager"!==$.name||U()})),Z.value=(null==(w=null==(m=O.value)?void 0:m.seo)?void 0:w.title)||(null==(j=O.value)?void 0:j.name)||G||"All Products",z.value=(null==(P=null==(q=O.value)?void 0:q.seo)?void 0:P.metaDesc)||(null==(S=O.value)?void 0:S.description)||`Products in category ${(null==(C=O.value)?void 0:C.name)||G||"All Products"}`,k({title:Z.value,meta:[{name:"description",content:z.value},{property:"og:title",content:(null==(b=null==(_=O.value)?void 0:_.seo)?void 0:b.opengraphTitle)||Z.value},{property:"og:description",content:(null==(D=null==(R=O.value)?void 0:R.seo)?void 0:D.opengraphDescription)||z.value}],link:[{rel:"canonical",href:(null==(L=null==(F=O.value)?void 0:F.seo)?void 0:L.canonical)||""}]}),null!=(A=null==(I=null==(M=O.value)?void 0:M.seo)?void 0:I.schema)&&A.raw&&k({script:[{type:"application/ld+json",innerHTML:O.value.seo.schema.raw}]}),(a,s,i,u)=>{var n;const m=e,g=o,y=r,h=l,f=t;s(`<div${c(p({class:"container px-2"},u))}>`),null!=(n=d(Q))&&n.length,s('<div class="flex items-start gap-16">'),d(Y).showFilters?s(v(m,{"hide-categories":!0},null,i)):s("\x3c!----\x3e"),s('<div class="w-full"><div class="flex items-center justify-between w-full gap-4 mt-8 md:gap-8">'),s(v(g,null,null,i)),d(Y).showOrderByDropdown?s(v(y,{class:"hidden md:inline-flex"},null,i)):s("\x3c!----\x3e"),d(Y).showFilters?s(v(h,{class:"md:hidden"},null,i)):s("\x3c!----\x3e"),s("</div>"),s(v(f,null,null,i)),s("</div></div>"),s("</div>")}}}),j=w.setup;w.setup=(e,o)=>{const r=m();return(r.modules||(r.modules=new Set)).add("woonuxt_base/app/pages/produkt-kategoriya/[slug].vue"),j?j(e,o):void 0};export{w as default};
//# sourceMappingURL=_slug_-B8NnNtl7.mjs.map
